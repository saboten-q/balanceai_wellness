# BalanceAI Wellness アプリケーション仕様書

## 目次
1. [プロジェクト概要](#プロジェクト概要)
2. [機能仕様](#機能仕様)
3. [技術仕様](#技術仕様)
4. [データモデル](#データモデル)
5. [AI機能](#ai機能)
6. [画面構成](#画面構成)
7. [ユーザーフロー](#ユーザーフロー)

---

## プロジェクト概要

### アプリケーション名
**BalanceAI Wellness**

### コンセプト
AI技術を活用した個人向けフィットネス・健康管理アプリケーション。ユーザーの目標や体質に合わせて、パーソナライズされたワークアウトプランと栄養管理を提供します。

### ターゲットユーザー
- 健康的な体づくりを目指す方
- ダイエットや筋力トレーニングを始めたい方
- パーソナライズされた運動・食事管理を求める方
- 自宅またはジムでトレーニングを行う方

### 主な価値提案
1. **AIによるパーソナライゼーション**: Google Gemini AIを活用し、個々のユーザーに最適化されたプランを自動生成
2. **包括的な健康管理**: 運動・食事・体重を一元管理
3. **インタラクティブなサポート**: AIチャットボットによる24/7サポート
4. **シンプルで美しいUI**: 直感的で使いやすいモダンなデザイン

---

## 機能仕様

### 1. 認証・オンボーディング

#### 1.1 認証画面
- **ランディング画面**
  - アプリのブランディング表示
  - ログイン/会員登録ボタン
  - 「登録せずに利用する」オプション
  
- **ログイン機能**
  - メールアドレス・パスワード入力
  - ローカルストレージベースの簡易認証（Mock実装）
  
- **会員登録機能**
  - オンボーディングフローへ遷移

#### 1.2 オンボーディング（3ステップ）
**ステップ1: 基本情報**
- 名前（ニックネーム）
- 性別（男性/女性/その他）
- 年齢

**ステップ2: 身体情報**
- 身長（cm）
- 現在の体重（kg）
- 目標体重（kg）
- トレーニング環境（自宅/ジム）
- 運動レベル（低い/普通/高い）

**ステップ3: 目標設定**
- 具体的な目標の自由記述（例: 夏までに腹筋を割りたい）

### 2. ダッシュボード

#### 2.1 ヘッダー
- ユーザー名の表示
- 目標体重までの残り表示

#### 2.2 Daily Message（AIメッセージ）
- 毎日更新される励ましのメッセージ
- カロリー摂取状況に基づいた個別アドバイス
- ローカルストレージにキャッシュ（日付ベース）

#### 2.3 栄養カード
- 本日の摂取カロリー表示
- 目標カロリーとの比較
- プログレスバー表示
- オーバー/適正/不足の視覚的表示

#### 2.4 ワークアウトカード
- 本日のトレーニング内容
- 完了メニュー数の表示
- ワークアウト画面への遷移

#### 2.5 体重カード
- 現在の体重表示
- プログレス画面への遷移

### 3. ワークアウト機能

#### 3.1 週間トレーニングプラン
- 7日間のトレーニングスケジュール
- 日別のフォーカス部位表示
- 曜日選択タブ

#### 3.2 エクササイズリスト
各エクササイズには以下を含む：
- エクササイズ名
- タイプ（筋力/有酸素/柔軟性）
- 推奨時間/回数
- 詳細説明
- 完了チェックボックス
- YouTube解説動画へのリンク（自動検索）

#### 3.3 ワークアウト専用AIチャット
- トレーニング内容に関する質問対応
- フォーム改善のアドバイス
- 代替エクササイズの提案
- 怪我や痛みへの対処法
- ストリーミング形式のレスポンス

### 4. 栄養管理機能

#### 4.1 食事ログ一覧
- 時系列での食事記録表示
- 各ログの詳細情報：
  - 食事名
  - カロリー、タンパク質、脂質、炭水化物
  - AIによる栄養アドバイス
  - タイムスタンプ

#### 4.2 食事記録追加
- **写真撮影/アップロード機能**（UI実装済み）
- **テキスト入力方式**
  - 食事内容を文字で入力
  - AIが自動で栄養素を推定
  - 健康アドバイスを生成

### 5. プログレス（進捗管理）機能

#### 5.1 体重グラフ
- 時系列の体重変化をライングラフで表示
- 目標体重のリファレンスライン
- インタラクティブなツールチップ

#### 5.2 体重記録
- 新しい体重の追加フォーム
- 記録日時の自動保存

### 6. グローバルAIチャット

#### 6.1 フローティングチャットボタン
- 画面右下に常時表示
- どの画面からもアクセス可能

#### 6.2 AIトレーナーチャット
- フィットネス・栄養に関する質問対応
- ユーザープロフィールを考慮した回答
- 会話履歴の保持
- ストリーミング形式のレスポンス
- モーダル形式のUI

### 7. ナビゲーション

#### ボトムナビゲーションバー
- ホーム（ダッシュボード）
- 運動（ワークアウト）
- 食事（栄養管理）
- 分析（プログレス）

---

## 技術仕様

### フロントエンド技術スタック

#### フレームワーク・ライブラリ
- **React 19.2.0**: UIフレームワーク
- **TypeScript 5.8.2**: 型安全な開発
- **Vite 6.2.0**: ビルドツール・開発サーバー

#### UI・スタイリング
- **TailwindCSS**: ユーティリティファーストCSSフレームワーク
- **Lucide React**: アイコンライブラリ
- **Recharts**: グラフ描画ライブラリ

#### AI統合
- **@google/genai 1.30.0**: Google Gemini API統合

### プロジェクト構成

```
balanceai_wellness/
├── App.tsx                      # メインアプリケーションコンポーネント
├── index.tsx                    # エントリーポイント
├── index.html                   # HTMLテンプレート
├── types.ts                     # TypeScript型定義
├── components/
│   └── UIComponents.tsx         # 共通UIコンポーネント
├── services/
│   └── geminiService.ts         # Google Gemini AI統合
├── vite.config.ts               # Vite設定
├── tsconfig.json                # TypeScript設定
├── package.json                 # 依存関係管理
└── README.md                    # プロジェクトドキュメント
```

### ビルド・実行コマンド

```bash
# 依存関係インストール
npm install

# 開発サーバー起動（ポート3000）
npm run dev

# プロダクションビルド
npm run build

# ビルド結果のプレビュー
npm run preview
```

---

## データモデル

### UserProfile（ユーザープロフィール）
```typescript
{
  name: string;                    // ユーザー名
  age: number;                     // 年齢
  gender: Gender;                  // 性別（男性/女性/その他）
  height: number;                  // 身長（cm）
  weight: number;                  // 体重（kg）
  targetWeight: number;            // 目標体重（kg）
  hasGymAccess: boolean;           // ジムアクセスの有無
  goal: string;                    // 目標の自由記述
  activityLevel: string;           // 運動レベル
  recommendedCalories?: number;    // 推奨カロリー（AI計算）
}
```

### WorkoutPlan（ワークアウトプラン）
```typescript
{
  summary: string;                 // プランの概要
  recommendedCalories: number;     // 推奨カロリー
  schedule: DailyWorkout[];        // 7日間のスケジュール
}
```

### DailyWorkout（日別ワークアウト）
```typescript
{
  day: string;                     // 曜日
  focus: string;                   // フォーカス部位
  exercises: Exercise[];           // エクササイズリスト
}
```

### Exercise（エクササイズ）
```typescript
{
  id: string;                      // 一意識別子（UUID）
  name: string;                    // エクササイズ名
  type: string;                    // タイプ（Strength/Cardio/Flexibility）
  duration: string;                // 時間・回数
  description: string;             // 説明
  isCompleted?: boolean;           // 完了状態
}
```

### DietLog（食事ログ）
```typescript
{
  id: string;                      // 一意識別子
  timestamp: Date;                 // 記録日時
  foodName: string;                // 食事名
  macros: MacroNutrients;          // 栄養素
  advice: string;                  // AIアドバイス
  imageUrl?: string;               // 画像URL（オプション）
}
```

### MacroNutrients（栄養素）
```typescript
{
  calories: number;                // カロリー
  protein: number;                 // タンパク質（g）
  fat: number;                     // 脂質（g）
  carbs: number;                   // 炭水化物（g）
}
```

### WeightLog（体重ログ）
```typescript
{
  id: string;                      // 一意識別子
  date: string;                    // 日付（YYYY-MM-DD）
  weight: number;                  // 体重（kg）
}
```

### ChatMessage（チャットメッセージ）
```typescript
{
  id: string;                      // 一意識別子
  role: 'user' | 'ai';            // 送信者
  text: string;                    // メッセージ内容
  timestamp: Date;                 // 送信日時
}
```

---

## AI機能

### Google Gemini AI統合

#### 使用モデル
- **gemini-2.5-flash**: 高速レスポンスが必要な全ての機能で使用

### AI機能詳細

#### 1. ワークアウトプラン生成（generateWorkoutPlan）
**入力**:
- ユーザープロフィール全情報
- ジムアクセスの有無
- 運動レベル
- 具体的な目標

**処理**:
- BMR（基礎代謝率）の計算
- 目標体重達成に必要な推奨カロリーの算出
- 環境（自宅/ジム）に応じたエクササイズの選定
- 7日間のバランスの取れたスケジュール作成

**出力**:
- 構造化されたJSON形式のワークアウトプラン
- 推奨カロリー
- 日別のエクササイズリスト

#### 2. 食事分析（analyzeFoodImage）
**入力**:
- Base64エンコードされた画像（オプション）
- テキストによる食事の説明

**処理**:
- 画像認識または自然言語理解による食事内容の特定
- カロリー・マクロ栄養素の推定
- 栄養バランスの評価
- 健康的なアドバイスの生成

**出力**:
- 食事名
- カロリー・タンパク質・脂質・炭水化物の値
- パーソナライズされたアドバイス

#### 3. 日次励ましメッセージ（generateDailyEncouragement）
**入力**:
- ユーザープロフィール
- 本日の摂取カロリー
- 目標カロリー

**処理**:
- 進捗状況の評価
- 適切なトーンの選択
- 60文字以内の短いメッセージ生成

**出力**:
- モチベーションを高める日本語メッセージ

#### 4. AIチャット（streamChatMessage）
**入力**:
- 会話履歴
- ユーザープロフィール
- 現在のコンテキスト（現在見ている画面情報）

**処理**:
- ユーザーの質問内容の理解
- プロフィールに基づいた回答生成
- コンテキストを考慮した具体的なアドバイス
- ストリーミング形式での段階的な出力

**出力**:
- リアルタイムでストリーミングされる回答テキスト
- 簡潔で実用的なアドバイス（200文字以内推奨）

### AI応答の特徴
- 絵文字を使用しない（UIアイコンに統一）
- 日本語での応答
- 安全で実現可能なアドバイス
- ユーザーの状況に応じたパーソナライゼーション

---

## 画面構成

### 1. 認証画面（AuthScreen）
- ランディングビュー
- ログインフォーム
- 登録フォーム
- グラデーション背景とアニメーション

### 2. オンボーディング画面（Onboarding）
- 3ステップのウィザード形式
- プログレスインジケーター
- 戻る/次へのナビゲーション
- ローディング状態表示

### 3. ダッシュボード画面（Dashboard）
- ユーザー情報ヘッダー
- AI Daily Messageカード
- 栄養カード（大）
- ワークアウトカード
- 体重カード
- グリッドレイアウト

### 4. ワークアウト画面（WorkoutView）
- 週間スケジュールタブ
- エクササイズリスト
- チェックボックスでの完了管理
- YouTube解説動画リンク
- コンテキスト別AIチャット

### 5. 栄養管理画面（DietView）
- 食事ログタイムライン
- 追加ボタン（フローティング）
- 食事記録モーダル
- 写真アップロードエリア
- テキスト入力フィールド

### 6. プログレス画面（ProgressView）
- 体重履歴グラフ
- 目標ライン表示
- 体重記録フォーム
- カード形式のレイアウト

### 7. グローバルAIチャットモーダル
- フルスクリーンモーダル
- チャット履歴表示
- 入力フィールド
- 送信ボタン
- ストリーミング表示

### 8. ボトムナビゲーション
- 4つのメインセクション
- アイコン + ラベル
- アクティブ状態のビジュアルフィードバック
- 固定位置・半透明背景

---

## ユーザーフロー

### 初回利用フロー
```
1. アプリ起動
   ↓
2. 認証画面（ランディング）
   ↓
3a. 「登録せずに利用する」→ オンボーディング
3b. 「会員登録」→ オンボーディング
3c. 「ログイン」→ ダッシュボード（既存ユーザー）
   ↓
4. オンボーディング（ステップ1-3）
   ↓
5. AIがワークアウトプランを生成（ローディング）
   ↓
6. ダッシュボード表示（初期メッセージ表示）
   ↓
7. 通常利用開始
```

### 日常利用フロー

**朝のルーティン**
```
1. アプリ起動
   ↓
2. ダッシュボードで本日のAIメッセージ確認
   ↓
3. ワークアウト画面で今日のメニュー確認
   ↓
4. エクササイズ実行しながらチェックマーク
   ↓
5. 不明点があればAIチャットで質問
```

**食事記録フロー**
```
1. 食事画面を開く
   ↓
2. 追加ボタンをタップ
   ↓
3. 食事内容を入力（テキストまたは写真）
   ↓
4. AIが栄養素を分析
   ↓
5. 結果とアドバイスを表示
   ↓
6. ダッシュボードのカロリー表示が更新
```

**週次レビューフロー**
```
1. プログレス画面を開く
   ↓
2. 体重グラフで推移を確認
   ↓
3. 現在の体重を記録
   ↓
4. 必要に応じてグローバルAIチャットで相談
   ↓
5. プランの見直しをAIに依頼
```

---

## データ永続化

### ローカルストレージの使用
すべてのデータはブラウザのローカルストレージに保存されます。

#### 保存されるデータ
- `profile`: ユーザープロフィール
- `workoutPlan`: ワークアウトプラン
- `dietLogs`: 食事ログの配列
- `weightLogs`: 体重ログの配列
- `dailyMessage`: 本日のAIメッセージ
- `dailyMessageDate`: メッセージの生成日

#### データの同期
- プロフィール、プラン、ログは変更時に自動保存
- Daily Messageは日付が変わると再生成

---

## セキュリティとプライバシー

### データの取り扱い
- すべてのデータはローカルストレージに保存
- サーバーへのデータ送信は最小限（AI APIコールのみ）
- 画像はBase64エンコードでAIに送信（保存はオプション）

### API認証
- Google Gemini APIキーは環境変数で管理
- `.env.local`ファイルに保存（Gitignore対象）

---

## 今後の拡張可能性

### 実装予定の機能
1. **バックエンド統合**
   - ユーザー認証（Firebase Auth等）
   - クラウドデータベース（Firestore等）
   - データの同期と復元

2. **ソーシャル機能**
   - 友達との進捗共有
   - リーダーボード
   - コミュニティチャレンジ

3. **高度な分析**
   - 週次・月次レポート
   - トレンド分析
   - 目標達成予測

4. **通知機能**
   - ワークアウトリマインダー
   - 食事記録の促し
   - 励ましのプッシュ通知

5. **ウェアラブル統合**
   - Apple Health / Google Fit連携
   - リアルタイムの活動量トラッキング

6. **栄養機能の拡張**
   - バーコードスキャン
   - レシピ提案
   - 食材管理

---

## まとめ

BalanceAI Wellnessは、最新のAI技術とモダンなWeb技術を活用した、ユーザーフレンドリーな健康管理アプリケーションです。パーソナライゼーション、包括的な機能、美しいUI、そして実用的なAIサポートにより、ユーザーの健康目標達成をサポートします。

**バージョン**: 1.0.0  
**最終更新**: 2025年12月4日

